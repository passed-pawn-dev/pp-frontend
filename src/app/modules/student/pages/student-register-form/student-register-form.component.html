<div class="page-wrapper">
  <div class="header">
    <a class="secondary-btn" routerLink="/">Back to home page</a>
  </div>
  <div class="tile">
    <app-step-indicator [stepNumber]="5" [currentStep]="step"></app-step-indicator>
    <h2>Student Registration</h2>
    <form class="register-form" [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <div #carousel="appCarousel" class="step-container" appCarousel>
        <div class="step" [class.step-active]="step === 1">
          <div class="form-control-field">
            <label for="username">Username</label>
            <input
              formControlName="username"
              type="text"
              class="standard-input"
              required
            />
            <app-validation-errors
              [errors]="registerForm.controls.username.errors"
              [dirty]="registerForm.controls.username.dirty"
              [touched]="registerForm.controls.username.touched"
            />
          </div>

          <div class="form-control-field">
            <label for="firstName">First name</label>
            <input
              formControlName="firstName"
              type="text"
              class="standard-input"
              required
            />
            <app-validation-errors
              [errors]="registerForm.controls.firstName.errors"
              [dirty]="registerForm.controls.firstName.dirty"
              [touched]="registerForm.controls.firstName.touched"
            />
          </div>

          <div class="form-control-field">
            <label for="lastName">Last name</label>
            <input
              id="lastName"
              formControlName="lastName"
              type="text"
              class="standard-input"
              required
            />
            <app-validation-errors
              [errors]="registerForm.controls.lastName.errors"
              [dirty]="registerForm.controls.lastName.dirty"
              [touched]="registerForm.controls.lastName.touched"
            />
          </div>
        </div>

        <div class="step" [class.step-active]="step === 2">
          <div class="form-control-field">
            <label for="email">Email</label>
            <input
              id="email"
              formControlName="email"
              type="email"
              class="standard-input"
              required
            />
            <app-validation-errors
              [errors]="registerForm.controls.email.errors"
              [dirty]="registerForm.controls.email.dirty"
              [touched]="registerForm.controls.email.touched"
            />
          </div>

          <div class="form-control-field">
            <label for="phoneNumber">Phone number</label>
            <input
              id="phoneNumber"
              formControlName="phoneNumber"
              type="text"
              class="standard-input"
              required
            />
            <app-validation-errors
              [errors]="registerForm.controls.phoneNumber.errors"
              [dirty]="registerForm.controls.phoneNumber.dirty"
              [touched]="registerForm.controls.phoneNumber.touched"
            />
          </div>

          <div class="form-control-field p-fluid">
            <label for="dateOfBirth">Date of birth</label>
            <div class="calendar">
              <p-date-picker
                fluid
                severity="secondary"
                appendTo="body"
                id="dateOfBirth"
                formControlName="dateOfBirth"
                type="date"
                showIcon="true"
                class="pg-input"
                [iconDisplay]="'input'"
                [maxDate]="maxDate"
              />
            </div>
          </div>
        </div>

        <div class="step" [class.step-active]="step === 3">
          <div class="form-control-field p-fluid">
            <label for="elo">Fide rating</label>
            <div class="inputNumber">
              <p-inputNumber
                id="elo"
                formControlName="elo"
                type="number"
                fluid
                severity="secondary"
                class="pg-inputnumber"
              />
            </div>
            <app-validation-errors
              [errors]="registerForm.controls.elo.errors"
              [dirty]="registerForm.controls.elo.dirty"
              [touched]="registerForm.controls.elo.touched"
            />
          </div>

          <!-- <div class="form-control-field">
          <label for="chessTitle">Chess title</label>
          <div class="dropdown">
            <p-select
              formControlName="chessTitle"
              optionLabel="label"
              optionValue="enumValue"
              placeholder="Select title"
              [options]="chessTitles"
            />
          </div>
        </div> -->

          <div class="form-control-field p-fluid">
            <label for="nationalityId">Nationality</label>
            <div class="autoComplete">
              <p-autoComplete
                fluid
                severity="secondary"
                formControlName="nationalityId"
                class="pg-autocomplete"
                [dropdown]="true"
                [suggestions]="filteredCountries"
                (completeMethod)="filterCountries($event)"
              />
            </div>
          </div>
        </div>

        <div class="step" [class.step-active]="step === 4">
          <div class="form-control-field">
            <label for="password">Password</label>
            <input
              id="password"
              formControlName="password"
              type="password"
              required
              class="standard-input"
            />
            <app-validation-errors
              [errors]="registerForm.controls.password.errors"
              [dirty]="registerForm.controls.password.dirty"
              [touched]="registerForm.controls.password.touched"
            />
          </div>
        </div>

        <div class="step" [class.step-active]="step === 5">
          <div class="text">
            You're almost done! Please review your details before submitting your
            account registration .
          </div>
          <img src="icons/elephant-register.png" alt="almost done" />
        </div>
      </div>
      <div class="btn-group">
        @if (step > 1) {
          <button
            type="button"
            class="secondary-btn"
            (click)="carousel.left(); prevStep()"
          >
            Back
          </button>
        } @else {
          <div></div>
        }
        @if (step === 5) {
          <button type="submit" class="primary-btn" [disabled]="registerForm.invalid">
            Register
          </button>
        } @else {
          <button
            type="button"
            class="primary-btn"
            (click)="carousel.right(); nextStep()"
          >
            Next <img src="icons/thick-arrow-right.png" alt="arrow" />
          </button>
        }
      </div>
    </form>
  </div>
</div>
